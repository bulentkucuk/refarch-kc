



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.0.1">
    
    
      
        <title>Overview - Container Shipment EDA reference implementation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.982221ab.css">
      
      
    
    
      <script src="../../assets/javascripts/modernizr.1f0bcf2b.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../extra.css">
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#reefer-container-shipment-solution-integration-tests" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="Container Shipment EDA reference implementation" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Container Shipment EDA reference implementation
            </span>
            <span class="md-header-nav__topic">
              Overview
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/ibm-cloud-architecture/refarch-kc/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="Container Shipment EDA reference implementation" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Container Shipment EDA reference implementation
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/ibm-cloud-architecture/refarch-kc/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Business problem statement
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Business problem statement
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../introduction/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../analysis/readme/" title="Event storming analysis" class="md-nav__link">
      Event storming analysis
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../design/readme/" title="From Analysis to Microservice Specifications" class="md-nav__link">
      From Analysis to Microservice Specifications
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../design/architecture/" title="Architecture" class="md-nav__link">
      Architecture
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Development practices
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Development practices
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="https://ibm-cloud-architecture.github.io/refarch-kc-order-ms" title="Order microservice with CQRS and Event Sourcing" class="md-nav__link">
      Order microservice with CQRS and Event Sourcing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="https://ibm-cloud-architecture.github.io/refarch-kc-container-ms/kstreams/" title="Container microservice with event sourcing and Kafka streams" class="md-nav__link">
      Container microservice with event sourcing and Kafka streams
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="https://ibm-cloud-architecture.github.io/refarch-kc-container-ms/flask" title="Container microservice with Python" class="md-nav__link">
      Container microservice with Python
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="https://ibm-cloud-architecture.github.io/refarch-kc-container-ms/springboot" title="Container microservice with Springboot - Spring Kafka and PostgreSQL" class="md-nav__link">
      Container microservice with Springboot - Spring Kafka and PostgreSQL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../avro/avro/" title="Adopting Schema Registry and Avro" class="md-nav__link">
      Adopting Schema Registry and Avro
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../deployments/reposlist/" title="Related repositories" class="md-nav__link">
      Related repositories
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Deployments
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Deployments
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../deployments/backing-services/" title="Backing Services" class="md-nav__link">
      Backing Services
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deployments/application-components/" title="Application Components" class="md-nav__link">
      Application Components
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../security/" title="Security" class="md-nav__link">
      Security
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9" checked>
    
    <label class="md-nav__link" for="nav-9">
      Integration tests
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        Integration tests
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Overview
      </label>
    
    <a href="./" title="Overview" class="md-nav__link md-nav__link--active">
      Overview
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#how-to-run-the-integration-test-cases" title="How to run the integration test cases" class="md-nav__link">
    How to run the integration test cases
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pre-requisites" title="Pre-requisites" class="md-nav__link">
    Pre-requisites
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run" title="Run" class="md-nav__link">
    Run
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#output" title="Output" class="md-nav__link">
    Output
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../happy-path/happy_path/" title="Happy Path" class="md-nav__link">
      Happy Path
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../saga/saga/" title="Saga Pattern" class="md-nav__link">
      Saga Pattern
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../containerAnomaly/containerAnomaly/" title="Container Anomaly" class="md-nav__link">
      Container Anomaly
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../demo/readme/" title="Demonstration script" class="md-nav__link">
      Demonstration script
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#how-to-run-the-integration-test-cases" title="How to run the integration test cases" class="md-nav__link">
    How to run the integration test cases
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pre-requisites" title="Pre-requisites" class="md-nav__link">
    Pre-requisites
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run" title="Run" class="md-nav__link">
    Run
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#output" title="Output" class="md-nav__link">
    Output
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/ibm-cloud-architecture/refarch-kc/edit/master/docs/itg-tests/itgtests.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="reefer-container-shipment-solution-integration-tests">Reefer container shipment solution integration tests</h1>
<p>The Reefer container shipment solution comes with a set of integration test cases to ensure the end to end functionality of the application. These test cases are part of our CI/CD process so that we ensure every new pull request that brings new code in does not break or modify the correct functionality of the application.</p>
<p>So far we have the following integration test cases:</p>
<ul>
<li><a href="../happy-path/happy_path/">Happy path</a> - End to end happy path test.</li>
<li><a href="../saga/saga/">SAGA pattern</a> - SAGA pattern for new order creation test.</li>
<li><a href="../containerAnomaly/containerAnomaly/">Container Anomaly</a> - Container anomaly and maintenance test.</li>
</ul>
<p>New integration test cases will be added in order to test other parts of the application as well as use cases and other Event Driven Patterns.</p>
<h2 id="how-to-run-the-integration-test-cases">How to run the integration test cases</h2>
<h3 id="pre-requisites">Pre-requisites</h3>
<p>In order to run the integration tests against the Reefer container shipment solution you first need to have this solution deployed on an Openshift or Kubernetes cluster. The solution is made up of:</p>
<ol>
<li>Backing services such as IBM Event Streams and PostgreSQL - Instructions <a href="https://ibm-cloud-architecture.github.io/refarch-kc/deployments/backing-services/">here</a>.</li>
<li>The Reefer container shipment solution components - Instructions <a href="https://ibm-cloud-architecture.github.io/refarch-kc/deployments/application-components/">here</a>.</li>
</ol>
<p>Once you have the solution deployed into your cluster, apart from an instance of IBM Event Streams and PostgreSQL either on premises or in IBM Cloud, you should have the following components at the very least for the integration tests to run:</p>
<div class="codehilite"><pre><span></span>$ oc get pods
NAME                                                READY     STATUS    RESTARTS   AGE
pod/ordercommandms-deployment-7cfcf65ffc-ffbxt      <span class="m">1</span>/1       Running   <span class="m">0</span>          32d
pod/orderqueryms-deployment-5ff4fd44d-ghrg6         <span class="m">1</span>/1       Running   <span class="m">0</span>          32d
pod/springcontainerms-deployment-7f78fc9b64-kt2pf   <span class="m">1</span>/1       Running   <span class="m">0</span>          32d
pod/voyagesms-deployment-7775bb8974-h8vj4           <span class="m">1</span>/1       Running   <span class="m">0</span>          32d
</pre></div>

<p>The integration test cases have been implemented to be run as a kubernetes job called <strong>reefer-itgtests-job</strong>. This job consist of a tailored python container where the integration tests, which are written in Python, will get executed in. The yaml file that will create such kubernetes job, called <strong>ReeferItgTests.yaml</strong>, can be found under the <code>itg-tests/es-it</code> folder in this very same repository. The reason for creating a tailored python container which to execute the integration tests in is because we can then control the execution environment for the integration tests. This way we ensure the appropriate libraries, permissions, etc are as expected. This tailored python container docker image is publicly available in the Docker Hub (<code>ibmcase/kcontainer-python:itgtests</code>). Please, make sure you can access the Docker Hub public registries from your OpenShift or Kubernetes cluster.</p>
<p>The integration tests also require of some variables being defined beforehand, some of which need to be defined as <strong>secrets or configMaps</strong> within your kubernetes namespace or OpenShift project, such as <code>KAFKA_APIKEY</code>, <code>KAFKA_BROKERS</code> and the IBM Event Streams PEM certificate (in case you are working with IBM Event Streams on premise), where the Reefer container shipment solution has been deployed into. You should have got these secrets or configMaps already created when deploying your backing services in #1 of this pre-requisites section.</p>
<p>Other required variables for the integration tests need to be defined within the kubernetes job yaml file:</p>
<ul>
<li>
<p>Orders topic name: This could be specified within the integration tests kubernetes job yaml file under the variable <strong>ITGTESTS_ORDERS_TOPIC</strong> which defaults to <code>itg-orders</code>.</p>
</li>
<li>
<p>Order Command topic name: This could be specified within the integration tests kubernetes job yaml file under the variable <strong>ITGTESTS_ORDER_COMMANDS_TOPIC</strong> which defaults to <code>itg-orderCommands</code>.</p>
</li>
<li>
<p>Containers topic name: This could be specified within the integration tests kubernetes job yaml file under the variable <strong>ITGTESTS_CONTAINERS_TOPIC</strong> which defaults to <code>itg-containers</code>.</p>
</li>
<li>
<p>Kafka Environment: It should be either <strong>OCP</strong> or <strong>IBMCLOUD</strong> depending on where your IBM Event Streams instance is deployed onto. If it is deployed on premises in your OpenShift or Kubernetes cluster, then it <code>KAFKA_ENV</code> should be set to <code>OCP</code>. If you are using an IBM Event Streams instance in the IBM Cloud, then <code>KAFKA_ENV</code> should be set to <code>IBMCLOUD</code>.</p>
</li>
</ul>
<p>This is important as the <strong>IBM Event Streams on-prem instances require a PEM certificate</strong> for the Kafka libraries to successfully connect to it. So, if you are using IBM Event Streams on-prem in your OpenShift or Kubernetes cluster, you also have to:</p>
<ol>
<li>Uncomment the bottom part of the integration tests kubernetes job yaml file.</li>
<li>Make sure you created the <strong>eventstreams-pem-file</strong> secret that will hold your IBM Event Streams PEM certificate, in step #1 of this pre-requisites section.</li>
</ol>
<p><strong>IMPORTANT:</strong> For the integration tests to work fine, we <strong>must</strong> mockup the BPM integration by pointing it to a testing post endpoint such as: <code>https://postman-echo.com/post</code>. For doing this, you will need to make sure the <strong>bpm-anomaly</strong> configMap you created for the Spring Container microservice component of the Reefer container shipment solution holds that testing post endpoint. You can do so by manually editing the configMap:</p>
<div class="codehilite"><pre><span></span>$ oc edit configmap bpm-anomaly -n eda-integration
</pre></div>

<p>The above will require to restart the Spring Container microservice component.</p>
<h3 id="run">Run</h3>
<p>In order to run the integration test cases for the Reefer container shipment solution, we need to create the the job that will run these. To create the job, we simply execute:</p>
<div class="codehilite"><pre><span></span>oc apply -f ReeferItgReefer.yaml -n &lt;namespace&gt;
</pre></div>

<p>You should see the following output:</p>
<div class="codehilite"><pre><span></span>job.batch/reefer-itgtests-job created
</pre></div>

<p>and if you list the pods in your namespace you should see a new pod which is running the integration tests:</p>
<div class="codehilite"><pre><span></span>$ oc get pods <span class="p">|</span> grep itgtests
NAME                                           READY     STATUS        RESTARTS   AGE
reefer-itgtests-job-x594k                      <span class="m">1</span>/1       Running       <span class="m">0</span>          2m
</pre></div>

<p>Once the integration tests have finished, the pod should transition to completed status:</p>
<div class="codehilite"><pre><span></span>$ oc get pods
NAME                                           READY     STATUS      RESTARTS   AGE
reefer-itgtests-job-x594k                      <span class="m">0</span>/1       Completed   <span class="m">0</span>          3m
</pre></div>

<p>and the job output should be like:</p>
<div class="codehilite"><pre><span></span>$ oc get <span class="nb">jobs</span>
NAME                      DESIRED   SUCCESSFUL   AGE
reefer-itgtests-job       <span class="m">1</span>         <span class="m">1</span>            3m
</pre></div>

<h2 id="output">Output</h2>
<p>If we want to inspect the output of the integration tests, we would need to get the logs for the pod that ran them:</p>
<div class="codehilite"><pre><span></span>$ oc logs e2e-reefer-itgtests-job-x594k
</pre></div>

<p>The output of the integration test cases is made up of a brief description of the execution environment:</p>
<div class="codehilite"><pre><span></span>-----------------------------------------------------------------
-- Reefer Container Shipment EDA application Integration Tests --
-----------------------------------------------------------------

Executing integrations tests from branch master of https://github.com/ibm-cloud-architecture/refarch-kc.git
Kafka Brokers: broker-0-hnkssdz.kafka.svc01.us-east.eventstreams.cloud.ibm.com:9093,broker-3-hnkssdz.kafka.svc01.us-east.eventstreams.cloud.ibm.com:9093,broker-5-hnkssdz.kafka.svc01.us-east.eventstreams.cloud.ibm.com:9093,broker-2-hnkssdz.kafka.svc01.us-east.eventstreams.cloud.ibm.com:9093,broker-1-hnkssdz.kafka.svc01.us-east.eventstreams.cloud.ibm.com:9093,broker-4-hnkssdz.kafka.svc01.us-east.eventstreams.cloud.ibm.com:9093
Kafka API Key: 98YA5dC-G6cODJtRFPJwi4DwNbwZABmsrSFI115jP6k5
Kafka Env: IBMCLOUD
Orders topic name: itg-orders
Order Command topic name: itg-orderCommands
Containers topic name: itg-containers
------------------------------------------------------------------
</pre></div>

<p>Then, each of the three test cases outlined in the introduction of this readme file will get executed, each of them beginning with a header like:</p>
<div class="codehilite"><pre><span></span>******************************************
******************************************
**********   E2E Happy Path   ************
******************************************
******************************************
</pre></div>

<p>After the header, the different tests within the test case will get executed. Each of these comes with a header and look like:</p>
<div class="codehilite"><pre><span></span>--------------------------------
--- <span class="o">[</span>TEST<span class="o">]</span> : Voyage Assigned ---
--------------------------------

<span class="m">1</span> - Load the expected voyage assigned event on the order topic from its json files
The expected voyage assigned event is:
<span class="o">{</span>
    <span class="s2">&quot;payload&quot;</span>: <span class="o">{</span>
        <span class="s2">&quot;orderID&quot;</span>: <span class="s2">&quot;a467070e-797e-40f9-9644-7393e8553f1f&quot;</span>,
        <span class="s2">&quot;voyageID&quot;</span>: <span class="s2">&quot;101&quot;</span>
    <span class="o">}</span>,
    <span class="s2">&quot;timestamp&quot;</span>: <span class="s2">&quot;&quot;</span>,
    <span class="s2">&quot;type&quot;</span>: <span class="s2">&quot;VoyageAssigned&quot;</span>,
    <span class="s2">&quot;version&quot;</span>: <span class="s2">&quot;1&quot;</span>
<span class="o">}</span>
Done

<span class="m">2</span> - Read voyage assigned from oder topic
<span class="o">[</span>KafkaConsumer<span class="o">]</span> - This is the configuration <span class="k">for</span> the consumer:
<span class="o">[</span>KafkaConsumer<span class="o">]</span> - <span class="o">{</span><span class="s1">&#39;bootstrap.servers&#39;</span>: <span class="s1">&#39;broker-0-hnkssdz.kafka.svc01.us-east.eventstreams.cloud.ibm.com:9093,broker-3-hnkssdz.kafka.svc01.us-east.eventstreams.cloud.ibm.com:9093,broker-5-hnkssdz.kafka.svc01.us-east.eventstreams.cloud.ibm.com:9093,broker-2-hnkssdz.kafka.svc01.us-east.eventstreams.cloud.ibm.com:9093,broker-1-hnkssdz.kafka.svc01.us-east.eventstreams.cloud.ibm.com:9093,broker-4-hnkssdz.kafka.svc01.us-east.eventstreams.cloud.ibm.com:9093&#39;</span>, <span class="s1">&#39;group.id&#39;</span>: <span class="s1">&#39;pythonconsumers&#39;</span>, <span class="s1">&#39;auto.offset.reset&#39;</span>: <span class="s1">&#39;earliest&#39;</span>, <span class="s1">&#39;enable.auto.commit&#39;</span>: True, <span class="s1">&#39;security.protocol&#39;</span>: <span class="s1">&#39;SASL_SSL&#39;</span>, <span class="s1">&#39;sasl.mechanisms&#39;</span>: <span class="s1">&#39;PLAIN&#39;</span>, <span class="s1">&#39;sasl.username&#39;</span>: <span class="s1">&#39;token&#39;</span>, <span class="s1">&#39;sasl.password&#39;</span>: <span class="s1">&#39;98YA5dC-G6cODJtRFPJwi4DwNbwZABmsrSFI115jP6k5&#39;</span><span class="o">}</span>
.<span class="o">[</span>KafkaConsumer<span class="o">]</span> - @@@ pollNextOrder itg-orders partition: <span class="o">[</span><span class="m">0</span><span class="o">]</span> at offset <span class="m">2</span> with key b<span class="s1">&#39;a467070e-797e-40f9-9644-7393e8553f1f&#39;</span>:
    value: <span class="o">{</span><span class="s2">&quot;timestamp&quot;</span>:1576667245430,<span class="s2">&quot;type&quot;</span>:<span class="s2">&quot;VoyageAssigned&quot;</span>,<span class="s2">&quot;version&quot;</span>:<span class="s2">&quot;1&quot;</span>,<span class="s2">&quot;payload&quot;</span>:<span class="o">{</span><span class="s2">&quot;voyageID&quot;</span>:<span class="s2">&quot;101&quot;</span>,<span class="s2">&quot;orderID&quot;</span>:<span class="s2">&quot;a467070e-797e-40f9-9644-7393e8553f1f&quot;</span><span class="o">}}</span>
This is the event <span class="nb">read</span> from the order topic:
<span class="o">{</span>
    <span class="s2">&quot;payload&quot;</span>: <span class="o">{</span>
        <span class="s2">&quot;orderID&quot;</span>: <span class="s2">&quot;a467070e-797e-40f9-9644-7393e8553f1f&quot;</span>,
        <span class="s2">&quot;voyageID&quot;</span>: <span class="s2">&quot;101&quot;</span>
    <span class="o">}</span>,
    <span class="s2">&quot;timestamp&quot;</span>: <span class="s2">&quot;&quot;</span>,
    <span class="s2">&quot;type&quot;</span>: <span class="s2">&quot;VoyageAssigned&quot;</span>,
    <span class="s2">&quot;version&quot;</span>: <span class="s2">&quot;1&quot;</span>
<span class="o">}</span>
Done

<span class="m">3</span> - Verify voyage assigned event
Done
</pre></div>

<p>A summary of the test case execution is shown at the end and look like:</p>
<div class="codehilite"><pre><span></span>----------------------------------------------------------------------
Ran <span class="m">7</span> tests in <span class="m">64</span>.262s

OK
</pre></div>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../../security/" title="Security" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Security
              </span>
            </div>
          </a>
        
        
          <a href="../happy-path/happy_path/" title="Happy Path" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Happy Path
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.b806dc00.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
    
  </body>
</html>